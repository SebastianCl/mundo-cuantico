<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El experimento m√°s bello de la f√≠sica - Simulaci√≥n Interactiva</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #063833 0%, #125450 100%);
            color: #ffffff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(12, 31, 29, 0.8);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 178, 0.3);
            color: #e0fffa;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #00FFB2, #00B7FF);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.8;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
            color: #00FFB2;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .controls {
            background: rgba(12, 31, 29, 0.8);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 178, 0.3);
            height: fit-content;
            color: #e0fffa;
        }

        .controls h3 {
            margin-bottom: 20px;
            color: #00FFB2;
            font-size: 1.3rem;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #00B7FF;
        }

        .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(3, 59, 53, 0.8);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            margin-bottom: 8px;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00FFB2, #00B7FF);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 255, 178, 0.5);
        }

        .slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00FFB2, #00B7FF);
            cursor: pointer;
            border: none;
            box-shadow: 0 0 10px rgba(0, 255, 178, 0.5);
        }

        .value-display {
            font-size: 0.9rem;
            color: #00FFB2;
            font-weight: bold;
        }

        .color-selector {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .color-option.selected {
            border-color: #ffffff;
            transform: scale(1.1);
            box-shadow: 0 0 15px currentColor;
        }

        .red {
            background: #ff0000;
        }

        .green {
            background: #00ff00;
        }

        .blue {
            background: #0080ff;
        }

        .violet {
            background: #8000ff;
        }

        .simulation-area {
            background: rgba(3, 59, 53, 0.8);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(0, 255, 178, 0.3);
            box-shadow: 0 0 30px rgba(0, 255, 178, 0.2);
            display: flex;
            flex-direction: column;
            height: 100%;
            min-height: 400px;
        }

        .experiment-setup {
            display: flex;
            align-items: center;
            justify-content: space-around;
            margin-bottom: 30px;
            height: auto;
            min-height: 150px;
            flex: 1;
            gap: 40px;
            padding: 20px;
        }

        .laser {
            width: 60px;
            height: 20px;
            background: linear-gradient(90deg, #333, #666);
            border-radius: 10px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 5px;
            z-index: 10;
        }

        .laser::after {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--laser-color, #ff0000);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--laser-color, #ff0000);
        }

        .laser-beam {
            height: 2px;
            background: linear-gradient(90deg, var(--laser-color, #ff0000), transparent);
            position: absolute;
            left: 60px;
            width: 100px;
            box-shadow: 0 0 5px var(--laser-color, #ff0000);
        }

        .cd-rom {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, #00FFB2, #00B7FF, #00FFEA, #12FF9B, #00FFB2);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px rgba(0, 255, 178, 0.5);
            margin: 0 30px;
        }

        .cd-rom::after {
            content: '';
            width: 15px;
            height: 15px;
            background: #000;
            border-radius: 50%;
        }

        .screen {
            width: 60%;
            height: 100%;
            min-height: 200px;
            max-height: 300px;
            background: #f0f0f0;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            margin-left: auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .diffraction-pattern {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }

        .info-panel {
            background: rgba(12, 31, 29, 0.8);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 178, 0.3);
            margin-top: 20px;
            color: #e0fffa;
        }

        .info-panel h3 {
            color: #00FFB2;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .measurements {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .measurement-item {
            background: rgba(0, 255, 178, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(0, 183, 255, 0.3);
        }

        .measurement-item strong {
            color: #00B7FF;
            display: block;
            margin-bottom: 5px;
        }

        .instructions {
            background: rgba(12, 31, 29, 0.8);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 178, 0.3);
            margin-top: 20px;
            color: #e0fffa;
        }

        .instructions h3 {
            color: #00FFB2;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .instructions ol {
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .materials-list {
            background: rgba(12, 31, 29, 0.8);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 178, 0.3);
            margin-top: 20px;
            color: #e0fffa;
        }

        .materials-list h3 {
            color: #00FFB2;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .materials-list ul {
            padding-left: 20px;
        }

        .materials-list li {
            margin-bottom: 8px;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2rem;
            }

            .experiment-setup {
                flex-direction: column;
                height: auto;
                gap: 30px;
                padding: 15px;
                align-items: center;
                justify-content: center;
            }

            .laser-beam {
                display: block;
                width: 60px;
                height: 3px;
                position: absolute;
                top: 50%;
                left: 100%;
                transform: translateY(-50%);
            }

            .laser {
                margin-top: 20px;
                position: relative;
            }

            .cd-rom {
                margin: 10px 0;
                width: 70px;
                height: 70px;
            }

            .simulation-area {
                min-height: 500px;
                padding: 15px;
            }

            .screen {
                min-height: 180px;
                max-height: 220px;
                width: 80%;
                margin: 0 auto;
            }
        }

        @media (min-width: 1400px) {
            .screen {
                min-height: 250px;
                max-height: 350px;
                width: 50%;
            }

            .simulation-area {
                min-height: 450px;
            }
        }

        /* Estilos para pantallas muy peque√±as como iPhone SE */
        @media (max-width: 375px) {
            .controls {
                padding: 15px;
            }

            .experiment-setup {
                gap: 15px;
                padding: 10px;
            }

            .cd-rom {
                width: 60px;
                height: 60px;
            }

            .laser {
                width: 50px;
                height: 15px;
            }

            .screen {
                min-height: 150px;
                width: 90%;
            }

            .simulation-area {
                min-height: 400px;
                padding: 12px;
            }

            .value-display {
                font-size: 0.8rem;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div style="display: flex; justify-content: flex-end; margin-top: 10px; margin-bottom: 10px;">
            <a href="../index.html"
                style="background: linear-gradient(135deg, #00FFB2, #00B7FF); color: #033b35; text-decoration: none; padding: 8px 15px; border-radius: 20px; display: flex; align-items: center; font-weight: bold; transition: all 0.3s ease; box-shadow: 0 3px 10px rgba(0,255,178,0.3);">
                <span style="margin-right: 5px;">üè†</span> Inicio
            </a>
        </div>
        <div class="header">
            <h1>El experimento m√°s bello de la f√≠sica</h1>
            <p>Simulaci√≥n interactiva del experimento de la doble rendija de Young usando un CD-ROM como red de
                difracci√≥n. Explora los fundamentos de la f√≠sica cu√°ntica y la naturaleza ondulatoria de la luz.</p>
        </div>

        <div class="main-content">
            <div class="controls">
                <h3>üéõÔ∏è Controles del experimento</h3>

                <div class="control-group">
                    <label for="wavelength">Longitud de onda del l√°ser:</label>
                    <input type="range" id="wavelength" class="slider" min="400" max="700" value="650">
                    <div class="value-display" id="wavelengthValue">650 nm (Rojo)</div>

                    <div class="color-selector">
                        <div class="color-option violet" data-wavelength="400" title="Violeta (400nm)"></div>
                        <div class="color-option blue" data-wavelength="470" title="Azul (470nm)"></div>
                        <div class="color-option green" data-wavelength="530" title="Verde (530nm)"></div>
                        <div class="color-option red selected" data-wavelength="650" title="Rojo (650nm)"></div>
                    </div>
                </div>

                <div class="control-group">
                    <label for="distance">Distancia CD-ROM a pantalla:</label>
                    <input type="range" id="distance" class="slider" min="20" max="100" value="50">
                    <div class="value-display" id="distanceValue">50 cm</div>
                </div>

                <div class="control-group">
                    <label for="pitDistance">Distancia entre pits del CD-ROM:</label>
                    <input type="range" id="pitDistance" class="slider" min="1400" max="1700" value="1600">
                    <div class="value-display" id="pitDistanceValue">1600 nm</div>
                </div>

                <div class="control-group">
                    <label for="intensity">Intensidad del l√°ser:</label>
                    <input type="range" id="intensity" class="slider" min="0.3" max="1" step="0.1" value="0.8">
                    <div class="value-display" id="intensityValue">80%</div>
                </div>
            </div>

            <div class="simulation-area">
                <h3>üî¨ Vista del experimento</h3>
                <div class="experiment-setup">
                    <div class="laser" id="laser">
                        <div class="laser-beam" id="laserBeam"></div>
                    </div>
                    <div class="cd-rom" id="cdrom"></div>
                    <div class="screen" id="screen">
                        <canvas id="diffractionCanvas" width="400" height="250"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div class="info-panel">
            <h3>üìä Mediciones y Resultados</h3>
            <div class="measurements">
                <div class="measurement-item">
                    <strong>√Ångulo del primer m√°ximo:</strong>
                    <span id="firstMaxAngle">0¬∞</span>
                </div>
                <div class="measurement-item">
                    <strong>Distancia entre m√°ximos:</strong>
                    <span id="maximaDistance">0 cm</span>
                </div>
                <div class="measurement-item">
                    <strong>N√∫mero de m√°ximos visibles:</strong>
                    <span id="visibleMaxima">0</span>
                </div>
                <div class="measurement-item">
                    <strong>Resoluci√≥n espectral:</strong>
                    <span id="spectralResolution">0 nm</span>
                </div>
            </div>
        </div>

        <div class="materials-list">
            <h3>üß™ Materiales necesarios para el experimento real</h3>
            <ul>
                <li>Un CD-ROM en su caja (el experimento no es destructivo)</li>
                <li>Un apuntador l√°ser o l√°ser astron√≥mico</li>
                <li>Un cart√≥n (cuarto de pliego o trozo de caja de m√°s de 30cm de longitud)</li>
                <li>Un par de gafas para cine 3D (se destruir√°n en el proceso)</li>
                <li>Transportador para medir √°ngulos</li>
                <li>Regla, l√°piz, calculadora, tijeras, cinta adhesiva</li>
            </ul>
        </div>

        <div class="instructions">
            <h3>üìã Instrucciones para el experimento real</h3>
            <ol>
                <li>Coloca el CD-ROM en posici√≥n vertical, asegurado con el cart√≥n</li>
                <li>Apunta el l√°ser hacia la mitad de la superficie reflectiva del CD-ROM</li>
                <li>El punto de reflexi√≥n debe estar alineado horizontalmente con el centro del CD</li>
                <li>Busca que la luz m√°s brillante se refleje directamente hacia el l√°ser</li>
                <li>Observa las otras reflexiones proyectadas en el cart√≥n</li>
                <li>Mide los √°ngulos y distancias entre los m√°ximos de difracci√≥n</li>
                <li>Prueba con diferentes colores de l√°ser si tienes disponibles</li>
                <li>Modifica la distancia del CD a la pantalla y observa los cambios</li>
            </ol>
        </div>
    </div>

    <script>
        class DiffractionSimulator {
            constructor() {
                this.canvas = document.getElementById('diffractionCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.wavelength = 650e-9; // metros
                this.distance = 0.5; // metros
                this.pitDistance = 1600e-9; // metros
                this.intensity = 0.8;

                this.resizeCanvas();
                this.initializeControls();
                this.updateSimulation();

                // Agregar evento de resize para actualizar el tama√±o del canvas
                window.addEventListener('resize', () => {
                    this.resizeCanvas();
                    this.updateSimulation();
                });
            }

            resizeCanvas() {
                const screen = document.getElementById('screen');
                if (screen) {
                    const screenRect = screen.getBoundingClientRect();

                    // Comprobar si estamos en un dispositivo m√≥vil
                    const isMobile = window.innerWidth <= 768;

                    // Limitar el tama√±o para que no sea demasiado grande
                    if (isMobile) {
                        this.canvas.width = Math.min(screenRect.width, 300);
                        this.canvas.height = Math.min(screenRect.height, 200);
                    } else {
                        this.canvas.width = Math.min(screenRect.width, 400);
                        this.canvas.height = Math.min(screenRect.height, 250);
                    }

                    // Para pantallas muy peque√±as
                    if (window.innerWidth <= 375) {
                        this.canvas.width = Math.min(screenRect.width, 200);
                        this.canvas.height = Math.min(screenRect.height, 150);
                    }

                    // Centrar el canvas en el contenedor
                    this.canvas.style.display = 'block';
                    this.canvas.style.margin = '0 auto';
                }
            } initializeControls() {
                // Wavelength slider
                const wavelengthSlider = document.getElementById('wavelength');
                const wavelengthValue = document.getElementById('wavelengthValue');

                wavelengthSlider.addEventListener('input', (e) => {
                    this.wavelength = parseInt(e.target.value) * 1e-9;
                    this.updateWavelengthDisplay(parseInt(e.target.value));
                    this.updateLaserColor(parseInt(e.target.value));
                    this.updateSimulation();
                });

                // Color selector
                document.querySelectorAll('.color-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        const wavelength = parseInt(e.target.dataset.wavelength);
                        wavelengthSlider.value = wavelength;
                        this.wavelength = wavelength * 1e-9;
                        this.updateWavelengthDisplay(wavelength);
                        this.updateLaserColor(wavelength);
                        this.updateColorSelection(e.target);
                        this.updateSimulation();
                    });
                });

                // Distance slider
                const distanceSlider = document.getElementById('distance');
                const distanceValue = document.getElementById('distanceValue');

                distanceSlider.addEventListener('input', (e) => {
                    this.distance = parseInt(e.target.value) * 0.01;
                    distanceValue.textContent = `${e.target.value} cm`;
                    this.updateSimulation();
                });

                // Pit distance slider
                const pitDistanceSlider = document.getElementById('pitDistance');
                const pitDistanceValue = document.getElementById('pitDistanceValue');

                pitDistanceSlider.addEventListener('input', (e) => {
                    this.pitDistance = parseInt(e.target.value) * 1e-9;
                    pitDistanceValue.textContent = `${e.target.value} nm`;
                    this.updateSimulation();
                });

                // Intensity slider
                const intensitySlider = document.getElementById('intensity');
                const intensityValue = document.getElementById('intensityValue');

                intensitySlider.addEventListener('input', (e) => {
                    this.intensity = parseFloat(e.target.value);
                    intensityValue.textContent = `${Math.round(e.target.value * 100)}%`;
                    this.updateSimulation();
                });
            }

            updateWavelengthDisplay(wavelength) {
                const wavelengthValue = document.getElementById('wavelengthValue');
                let color = '';
                if (wavelength < 450) color = 'Violeta';
                else if (wavelength < 495) color = 'Azul';
                else if (wavelength < 570) color = 'Verde';
                else if (wavelength < 590) color = 'Amarillo';
                else if (wavelength < 620) color = 'Naranja';
                else color = 'Rojo';

                wavelengthValue.textContent = `${wavelength} nm (${color})`;
            }

            updateLaserColor(wavelength) {
                let color = '';
                if (wavelength < 450) color = '#8000ff';
                else if (wavelength < 495) color = '#0080ff';
                else if (wavelength < 570) color = '#00ff00';
                else if (wavelength < 590) color = '#ffff00';
                else if (wavelength < 620) color = '#ff8000';
                else color = '#ff0000';

                document.documentElement.style.setProperty('--laser-color', color);
            }

            updateColorSelection(selectedOption) {
                document.querySelectorAll('.color-option').forEach(option => {
                    option.classList.remove('selected');
                });
                selectedOption.classList.add('selected');
            }

            updateSimulation() {
                this.clearCanvas();
                this.drawDiffractionPattern();
                this.updateMeasurements();
            }

            clearCanvas() {
                this.ctx.fillStyle = '#f0f0f0';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
            }

            drawDiffractionPattern() {
                const centerY = this.canvas.height / 2;
                const width = this.canvas.width;
                const centerX = width / 2;

                // Calcular el patr√≥n de difracci√≥n usando la ecuaci√≥n de la red de difracci√≥n
                // d * sin(Œ∏) = m * Œª

                // Primero determinar el ancho del patr√≥n de difracci√≥n basado en las condiciones
                const firstOrder = this.wavelength / this.pitDistance;
                const firstMaxAngle = Math.asin(firstOrder);

                // Usar diferentes factores de escala seg√∫n el tama√±o de la pantalla
                const isMobile = window.innerWidth <= 768;
                const isVerySmall = window.innerWidth <= 375;

                let scalingMultiplier = 3; // Factor para pantallas grandes
                if (isMobile) {
                    scalingMultiplier = 2.5; // Menos √≥rdenes visibles en m√≥viles
                }
                if (isVerySmall) {
                    scalingMultiplier = 2; // A√∫n menos √≥rdenes en pantallas muy peque√±as
                }

                const maxXOffset = this.distance * 100 * Math.tan(firstMaxAngle) * scalingMultiplier;
                const scaleFactor = (width * 0.9) / (2 * maxXOffset); // Usar 90% del ancho disponible

                for (let x = 0; x < width; x++) {
                    // Escalar x para que el patr√≥n est√© centrado y use el tama√±o adecuado
                    const scaledX = (x - centerX) / scaleFactor;
                    const angle = Math.atan(scaledX / (this.distance * 100)); // aproximaci√≥n de √°ngulo peque√±o
                    const sinTheta = Math.sin(angle);

                    // Calcular la intensidad usando la f√≥rmula de difracci√≥n de red
                    let intensity = 0;

                    // Condici√≥n de m√°ximos: d * sin(Œ∏) = m * Œª
                    const order = (this.pitDistance * sinTheta) / this.wavelength;
                    const fractionalPart = Math.abs(order - Math.round(order));

                    // Intensidad basada en qu√© tan cerca est√° de un m√°ximo
                    if (fractionalPart < 0.1) {
                        intensity = this.intensity * (1 - fractionalPart * 10);
                    }

                    // Aplicar una envolvente gaussiana para simular el ancho del haz
                    const envelope = Math.exp(-Math.pow(scaledX / (width / 8), 2));
                    intensity *= envelope;

                    // Dibujar la l√≠nea vertical con la intensidad calculada
                    if (intensity > 0.05) {
                        const alpha = Math.min(intensity, 1);
                        const wavelengthNm = this.wavelength * 1e9;
                        let color = '';

                        if (wavelengthNm < 450) color = `rgba(128, 0, 255, ${alpha})`;
                        else if (wavelengthNm < 495) color = `rgba(0, 128, 255, ${alpha})`;
                        else if (wavelengthNm < 570) color = `rgba(0, 255, 0, ${alpha})`;
                        else if (wavelengthNm < 590) color = `rgba(255, 255, 0, ${alpha})`;
                        else if (wavelengthNm < 620) color = `rgba(255, 128, 0, ${alpha})`;
                        else color = `rgba(255, 0, 0, ${alpha})`;

                        this.ctx.fillStyle = color;
                        const lineHeight = intensity * this.canvas.height * 0.8;
                        this.ctx.fillRect(x, centerY - lineHeight / 2, 1, lineHeight);
                    }
                }
            }

            updateMeasurements() {
                // Calcular el √°ngulo del primer m√°ximo
                const firstOrder = this.wavelength / this.pitDistance;
                const firstMaxAngle = Math.asin(firstOrder) * 180 / Math.PI;

                // Calcular la distancia entre m√°ximos en la pantalla
                const angularSeparation = this.wavelength / this.pitDistance;
                const linearSeparation = this.distance * Math.tan(angularSeparation) * 100; // en cm

                // Calcular el n√∫mero de m√°ximos visibles
                const maxOrder = Math.floor(this.pitDistance / this.wavelength);
                const visibleMaxima = Math.min(maxOrder, 10); // limitado por el tama√±o de la pantalla

                // Resoluci√≥n espectral aproximada
                const spectralResolution = this.wavelength * 1e9 / maxOrder;

                document.getElementById('firstMaxAngle').textContent = `${firstMaxAngle.toFixed(2)}¬∞`;
                document.getElementById('maximaDistance').textContent = `${linearSeparation.toFixed(2)} cm`;
                document.getElementById('visibleMaxima').textContent = `${visibleMaxima}`;
                document.getElementById('spectralResolution').textContent = `${spectralResolution.toFixed(1)} nm`;
            }
        }

        // Inicializar la simulaci√≥n cuando se carga la p√°gina
        window.addEventListener('load', () => {
            new DiffractionSimulator();
        });
    </script>
</body>

</html>
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jugando con el Esp√≠n</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            max-width: 1200px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .game-board {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        /* Cubo de Esp√≠n */
        .cube-section {
            text-align: center;
        }

        .cube-container {
            perspective: 1000px;
            margin: 20px auto;
            width: 150px;
            height: 150px;
        }

        .cube {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 1s cubic-bezier(0.4, 0.0, 0.2, 1);
            cursor: pointer;
        }

        .cube-face {
            position: absolute;
            width: 150px;
            height: 150px;
            border: 3px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            font-weight: bold;
            background: white;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1);
        }

        .cube-face.x { color: #ff4444; background: #ffe0e0; }
        .cube-face.y { color: #4444ff; background: #e0e0ff; }
        .cube-face.z { color: #44ff44; background: #e0ffe0; }

        .cube-face.front  { transform: rotateY(0deg) translateZ(75px); }
        .cube-face.back   { transform: rotateY(180deg) translateZ(75px); }
        .cube-face.right  { transform: rotateY(90deg) translateZ(75px); }
        .cube-face.left   { transform: rotateY(-90deg) translateZ(75px); }
        .cube-face.top    { transform: rotateX(90deg) translateZ(75px); }
        .cube-face.bottom { transform: rotateX(-90deg) translateZ(75px); }

        /* Cartas */
        .cards-section {
            text-align: center;
        }

        .deck {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            width: 120px;
            height: 180px;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .deck:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        .deck:active {
            transform: translateY(0);
        }

        .current-card {
            width: 120px;
            height: 180px;
            margin: 20px auto;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 72px;
            font-weight: bold;
            background: white;
            border: 3px solid #333;
            transition: all 0.5s;
            animation: cardFlip 0.6s ease-out;
        }

        @keyframes cardFlip {
            0% { transform: rotateY(180deg) scale(0.8); opacity: 0; }
            50% { transform: rotateY(90deg) scale(1.1); }
            100% { transform: rotateY(0deg) scale(1); opacity: 1; }
        }

        .card-x { color: #ff4444; background: #ffe0e0; }
        .card-y { color: #4444ff; background: #e0e0ff; }
        .card-z { color: #44ff44; background: #e0ffe0; }
        .card-b { color: #ff44ff; background: #ffe0ff; }
        .card-q { color: #ffaa00; background: #fff0e0; }
        .card-r { color: #00aaff; background: #e0f0ff; }

        /* Jugadores */
        .players-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
        }

        .player {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .player.active {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
            transform: scale(1.05);
        }

        .player-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .player-score {
            font-size: 24px;
            color: #667eea;
            font-weight: bold;
        }

        /* Moneda */
        .coin-section {
            text-align: center;
            margin-top: 20px;
        }

        .coin {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            border: 3px solid #b8860b;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            font-weight: bold;
            margin: 20px auto;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .coin:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .coin.flipping {
            animation: coinFlip 1s ease-in-out;
        }

        @keyframes coinFlip {
            0% { transform: rotateX(0); }
            50% { transform: rotateX(1800deg); }
            100% { transform: rotateX(3600deg); }
        }

        /* Controles */
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Info */
        .info-panel {
            background: #f0f0ff;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #333;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .stat {
            text-align: center;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .stat-value {
            color: #333;
            font-size: 24px;
            font-weight: bold;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            animation: fadeIn 0.3s;
        }

        .modal-content {
            position: relative;
            background: white;
            margin: 10% auto;
            padding: 30px;
            width: 80%;
            max-width: 500px;
            border-radius: 20px;
            text-align: center;
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .winner-text {
            font-size: 36px;
            color: #667eea;
            margin-bottom: 20px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .game-board {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>üé≤ Jugando con el Esp√≠n üß≤</h1>
        <p class="subtitle">Un juego cu√°ntico para explorar las propiedades del spin</p>
        
        <div class="game-board">
            <div class="cube-section">
                <h3>Cubo de Esp√≠n</h3>
                <div class="cube-container">
                    <div class="cube" id="cube">
                        <div class="cube-face front z">+Z</div>
                        <div class="cube-face back z">-Z</div>
                        <div class="cube-face right x">+X</div>
                        <div class="cube-face left x">-X</div>
                        <div class="cube-face top y">+Y</div>
                        <div class="cube-face bottom y">-Y</div>
                    </div>
                </div>
                <p id="cubeState">Estado: +Z</p>
            </div>
            
            <div class="cards-section">
                <h3>Cartas Magn√©ticas</h3>
                <div class="deck" id="deck" onclick="drawCard()">
                    <span id="cardsLeft">30</span> üìá
                </div>
                <div id="currentCard" style="display:none;" class="current-card"></div>
                
                <div class="coin-section">
                    <h4>Automedidor Cu√°ntico</h4>
                    <div class="coin" id="coin" onclick="flipCoin()">?</div>
                </div>
            </div>
            
            <div class="players-section">
                <h3>Jugadores</h3>
                <div id="playersList"></div>
            </div>
        </div>
        
        <div class="info-panel" id="infoPanel">
            Haz clic en el mazo para sacar una carta
        </div>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-label">Medidas Realizadas</div>
                <div class="stat-value" id="measureCount">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">Turno Actual</div>
                <div class="stat-value" id="turnCount">1</div>
            </div>
            <div class="stat">
                <div class="stat-label">Direcci√≥n</div>
                <div class="stat-value" id="direction">‚Üí</div>
            </div>
        </div>
        
        <div class="controls">
            <button onclick="startNewGame()">üéÆ Nuevo Juego</button>
            <button onclick="showRules()">üìñ Reglas</button>
            <button onclick="addPlayer()">‚ûï Agregar Jugador</button>
        </div>
    </div>
    
    <div class="modal" id="modal">
        <div class="modal-content">
            <div id="modalBody"></div>
            <button onclick="closeModal()" style="margin-top: 20px;">Cerrar</button>
        </div>
    </div>

    <script>
        // Estado del juego
        let gameState = {
            players: [
                { name: "Jugador 1", score: 0 },
                { name: "Jugador 2", score: 0 }
            ],
            currentPlayer: 0,
            cubeState: "+Z",
            direction: 1, // 1 = derecha, -1 = izquierda
            measureCount: 0,
            turnCount: 1,
            deck: [],
            usedCards: [],
            waitingForCoin: false,
            currentCard: null,
            gameEnded: false
        };

        // Configuraci√≥n del cubo
        const cubeRotations = {
            '+Z': 'rotateX(0deg) rotateY(0deg)',
            '-Z': 'rotateX(0deg) rotateY(180deg)',
            '+X': 'rotateY(90deg) rotateZ(0deg)',
            '-X': 'rotateY(-90deg) rotateZ(0deg)',
            '+Y': 'rotateX(-90deg) rotateZ(0deg)',
            '-Y': 'rotateX(90deg) rotateZ(0deg)'
        };

        // Inicializar el juego
        function initGame() {
            createDeck();
            updateDisplay();
            renderPlayers();
        }

        // Crear el mazo de cartas
        function createDeck() {
            gameState.deck = [];
            // Cartas X, Y, Z
            for (let i = 0; i < 8; i++) {
                gameState.deck.push('X');
                gameState.deck.push('Y');
                gameState.deck.push('Z');
            }
            // Cartas especiales
            for (let i = 0; i < 4; i++) {
                gameState.deck.push('B'); // Campo magn√©tico
                gameState.deck.push('Q'); // Quantum flip
            }
            for (let i = 0; i < 2; i++) {
                gameState.deck.push('R'); // Reversa
            }
            
            // Barajar
            gameState.deck = shuffleArray(gameState.deck);
        }

        // Barajar array
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // Sacar carta
        function drawCard() {
            if (gameState.waitingForCoin || gameState.gameEnded) return;
            
            let card;
            if (gameState.deck.length > 0) {
                card = gameState.deck.pop();
            } else if (gameState.usedCards.length > 0) {
                // Si se acabaron las cartas, usar las usadas
                gameState.deck = shuffleArray(gameState.usedCards);
                gameState.usedCards = [];
                card = gameState.deck.pop();
            } else {
                endGame();
                return;
            }
            
            gameState.currentCard = card;
            showCard(card);
            processCard(card);
        }

        // Mostrar carta
        function showCard(card) {
            const cardEl = document.getElementById('currentCard');
            cardEl.style.display = 'flex';
            cardEl.textContent = card;
            cardEl.className = 'current-card card-' + card.toLowerCase();
            
            // Agregar a cartas usadas
            gameState.usedCards.push(card);
        }

        // Procesar carta
        function processCard(card) {
            const player = gameState.players[gameState.currentPlayer];
            let message = `${player.name} sac√≥ ${card}. `;
            
            switch(card) {
                case 'X':
                case 'Y':
                    // Verificar si coincide con el estado del cubo
                    if (gameState.cubeState[1] === card) {
                        const points = gameState.cubeState[0] === '+' ? 1 : -1;
                        player.score += points;
                        message += `Estado coincide: ${points > 0 ? '+' : ''}${points} puntos`;
                        nextTurn();
                    } else {
                        gameState.waitingForCoin = true;
                        message += "Lanza el Automedidor Cu√°ntico";
                    }
                    break;
                    
                case 'Z':
                    // Verificar si coincide con el estado del cubo
                    if (gameState.cubeState[1] === 'Z') {
                        const points = gameState.cubeState[0] === '+' ? 1 : -1;
                        player.score += points;
                        message += `Estado coincide: ${points > 0 ? '+' : ''}${points} puntos`;
                    } else {
                        player.score += 1;
                        message += "+1 punto";
                    }
                    nextTurn();
                    break;
                    
                case 'B':
                    player.score -= 1;
                    message += "Campo magn√©tico aplicado: -1 punto. El cubo gira...";
                    randomRotateCube();
                    setTimeout(nextTurn, 1000);
                    break;
                    
                case 'Q':
                    gameState.waitingForCoin = true;
                    message += "Quantum Flip! Lanza el Automedidor";
                    break;
                    
                case 'R':
                    gameState.direction *= -1;
                    message += "¬°Reversa temporal! Cambia la direcci√≥n";
                    updateDisplay();
                    nextTurn();
                    break;
            }
            
            document.getElementById('infoPanel').textContent = message;
            updateDisplay();
        }

        // Lanzar moneda
        function flipCoin() {
            if (!gameState.waitingForCoin) return;
            
            const coin = document.getElementById('coin');
            coin.classList.add('flipping');
            
            setTimeout(() => {
                const result = Math.random() < 0.5 ? -1 : 1;
                coin.textContent = result > 0 ? '+' : '-';
                coin.classList.remove('flipping');
                
                processCoinResult(result);
            }, 1000);
        }

        // Procesar resultado de la moneda
        function processCoinResult(result) {
            const player = gameState.players[gameState.currentPlayer];
            const card = gameState.currentCard;
            
            if (card === 'Q') {
                // Quantum Flip
                player.score += result * 2;
                const newSign = result > 0 ? '+' : '-';
                const currentAxis = gameState.cubeState[1];
                gameState.cubeState = newSign + currentAxis;
                rotateCube();
                
                document.getElementById('infoPanel').textContent = 
                    `Quantum Flip: ${result > 0 ? '+2' : '-2'} puntos. Cubo: ${gameState.cubeState}`;
            } else {
                // Medida normal
                player.score += result;
                gameState.cubeState = (result > 0 ? '+' : '-') + card;
                rotateCube();
                gameState.measureCount++;
                
                document.getElementById('infoPanel').textContent = 
                    `Medida: ${result > 0 ? '+1' : '-1'} punto. Cubo: ${gameState.cubeState}`;
            }
            
            gameState.waitingForCoin = false;
            updateDisplay();
            
            // Verificar fin del juego
            if (gameState.measureCount >= 30) {
                setTimeout(endGame, 1500);
            } else {
                setTimeout(nextTurn, 1500);
            }
        }

        // Rotar cubo
        function rotateCube() {
            const cube = document.getElementById('cube');
            cube.style.transform = cubeRotations[gameState.cubeState];
            document.getElementById('cubeState').textContent = `Estado: ${gameState.cubeState}`;
        }

        // Rotaci√≥n aleatoria del cubo
        function randomRotateCube() {
            const states = ['+X', '-X', '+Y', '-Y', '+Z', '-Z'];
            gameState.cubeState = states[Math.floor(Math.random() * states.length)];
            rotateCube();
        }

        // Siguiente turno
        function nextTurn() {
            gameState.currentPlayer = (gameState.currentPlayer + gameState.direction + 
                gameState.players.length) % gameState.players.length;
            gameState.turnCount++;
            
            // Resetear moneda
            document.getElementById('coin').textContent = '?';
            
            updateDisplay();
            renderPlayers();
        }

        // Actualizar display
        function updateDisplay() {
            document.getElementById('measureCount').textContent = gameState.measureCount;
            document.getElementById('turnCount').textContent = gameState.turnCount;
            document.getElementById('direction').textContent = gameState.direction > 0 ? '‚Üí' : '‚Üê';
            document.getElementById('cardsLeft').textContent = gameState.deck.length;
            
            renderPlayers();
        }

        // Renderizar jugadores
        function renderPlayers() {
            const container = document.getElementById('playersList');
            container.innerHTML = '';
            
            gameState.players.forEach((player, index) => {
                const div = document.createElement('div');
                div.className = 'player' + (index === gameState.currentPlayer ? ' active' : '');
                div.innerHTML = `
                    <div class="player-name">${player.name}</div>
                    <div class="player-score">${player.score} pts</div>
                `;
                container.appendChild(div);
            });
        }

        // Agregar jugador
        function addPlayer() {
            if (gameState.players.length >= 4) {
                alert('M√°ximo 4 jugadores');
                return;
            }
            
            const name = prompt('Nombre del jugador:');
            if (name) {
                gameState.players.push({ name, score: 0 });
                renderPlayers();
            }
        }

        // Nuevo juego
        function startNewGame() {
            if (confirm('¬øIniciar un nuevo juego?')) {
                gameState.currentPlayer = 0;
                gameState.cubeState = '+Z';
                gameState.direction = 1;
                gameState.measureCount = 0;
                gameState.turnCount = 1;
                gameState.waitingForCoin = false;
                gameState.currentCard = null;
                gameState.gameEnded = false;
                gameState.usedCards = [];
                
                gameState.players.forEach(p => p.score = 0);
                
                document.getElementById('currentCard').style.display = 'none';
                document.getElementById('coin').textContent = '?';
                document.getElementById('infoPanel').textContent = 'Haz clic en el mazo para sacar una carta';
                
                createDeck();
                rotateCube();
                updateDisplay();
            }
        }

        // Fin del juego
        function endGame() {
            gameState.gameEnded = true;
            
            const winner = gameState.players.reduce((prev, current) => 
                (prev.score > current.score) ? prev : current
            );
            
            const modalBody = document.getElementById('modalBody');
            modalBody.innerHTML = `
                <div class="winner-text">üèÜ ¬°Juego Terminado! üèÜ</div>
                <h2>Ganador: ${winner.name}</h2>
                <h3>Puntuaci√≥n: ${winner.score} puntos</h3>
                <hr style="margin: 20px 0;">
                <h4>Puntuaciones Finales:</h4>
                ${gameState.players.map(p => 
                    `<p>${p.name}: ${p.score} puntos</p>`
                ).join('')}
                <p style="margin-top: 20px;">Medidas realizadas: ${gameState.measureCount}</p>
            `;
            
            document.getElementById('modal').style.display = 'block';
        }

        // Mostrar reglas
        function showRules() {
            const modalBody = document.getElementById('modalBody');
            modalBody.innerHTML = `
                <h2>üìñ Reglas del Juego</h2>
                <div style="text-align: left; max-height: 400px; overflow-y: auto;">
                    <h3>Objetivo</h3>
                    <p>Acumular la mayor cantidad de puntos despu√©s de 30 medidas cu√°nticas.</p>
                    
                    <h3>Cartas y Acciones</h3>
                    <p><strong>X, Y:</strong> Si coincide con el cubo, ganas/pierdes seg√∫n el signo. Si no, lanza la moneda para medir.</p>
                    <p><strong>Z:</strong> Si coincide con el cubo, ganas/pierdes seg√∫n el signo. Si no, +1 punto directo.</p>
                    <p><strong>B (Campo Magn√©tico):</strong> -1 punto, el cubo gira aleatoriamente.</p>
                    <p><strong>Q (Quantum Flip):</strong> Lanza la moneda, ganas/pierdes el doble y el cubo cambia de signo.</p>
                    <p><strong>R (Reversa):</strong> Cambia la direcci√≥n del juego.</p>
                    
                    <h3>Automedidor Cu√°ntico (Moneda)</h3>
                    <p>+ = +1 punto | - = -1 punto</p>
                    <p>Al medir, el cubo cambia al estado medido.</p>
                    
                    <h3>Fin del Juego</h3>
                    <p>El juego termina despu√©s de 30 medidas. ¬°El jugador con m√°s puntos gana!</p>
                </div>
            `;
            
            document.getElementById('modal').style.display = 'block';
        }

        // Cerrar modal
        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        // Inicializar al cargar
        window.onload = initGame;
    </script>
</body>
</html>